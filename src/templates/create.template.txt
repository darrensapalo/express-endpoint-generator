
import express from "express";

import {pipe} from "rxjs";

import <MODEL_NAME>, { AddDisplayNameProperty } from '@models/<MODEL_NAME>';

import ServiceEndpoint from "@design/service-endpoint";
import {ValidResourceRequest} from "@design/validators";
import {mergeMap, map} from "rxjs/operators";
import {findOneModel} from "@design/model-operators";
import {FindResourceFromParam} from "@design/mappers";
import {FindResourceRequest} from "@interfaces/request";
import { SuccessfulProcess } from '@design/processors';

/**
 * Returns the full details of an instance of a <MODEL_NAME>.
 *
 * This endpoint was automatically generated on <TIMESTAMP>
 * using the `node-express-endpoint-generator` package.
 * 
 * @param request The HTTP request
 * @param response The HTTP response
 */
export default function get(request: express.Request, response: express.Response) {

    const endpoint = new ServiceEndpoint<FindResourceRequest>("Fetch <MODEL_NAME> instance");

    endpoint.Validators = [ ValidResourceRequest(<MODEL_NAME>) ];

    endpoint.RequestMapper = FindResourceFromParam(<MODEL_NAME>);

    endpoint.Processor = pipe(
        mergeMap(findOneModel<<MODEL_NAME>>(<MODEL_NAME>)),
        map(AddDisplayNameProperty),
        SuccessfulProcess("Successfully fetched <MODEL_NAME> instance.", { shouldLogProcess: false })
    );

    endpoint.perform(request, response);
}